<!DOCTYPE html>
<html lang="en">
    <head>
        <link rel="stylesheet" href="../css/form-popup.css">
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN" crossorigin="anonymous">
        <script src="https://code.jquery.com/jquery-3.7.1.min.js" integrity="sha256-/JqT3SQfawRcv/BIHPThkBvs0OEvtFFmqPF/lYI/Cxo=" crossorigin="anonymous"></script>
        <script src="../js/jquery.twbsPagination.min.js"></script>
        <title>책 검색</title>
        <script defer src="../js/isbn.js"></script>
    </head>
    <body>
        <header>
            <h1>책 검색</h1>
        </header>
        <main>
            <div class="search" id = "kakao">
                <input id = "bookname" value="" type = "text" placeholder="책 이름 또는 저자 또는 출판사를 적어주세요.">
                <button id = "search" class="btn btn-outline-secondary">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-search" viewBox="0 0 16 16">
                        <path d="M11.742 10.344a6.5 6.5 0 1 0-1.397 1.398h-.001c.03.04.062.078.098.115l3.85 3.85a1 1 0 0 0 1.415-1.414l-3.85-3.85a1.007 1.007 0 0 0-.115-.1zM12 6.5a5.5 5.5 0 1 1-11 0 5.5 5.5 0 0 1 11 0z"/>
                    </svg>
                </button>
            </div>
            <div class="container text-center">
                <div class="context row row-cols-2"> </div>
            </div>
            <div class="container">
                <ul class="pagination" id="pagination"></ul>
            </div>
        </main>
        <script>
            // var search_name;
            // var page_num = 1;
            // var totalPages;
            // var first = true;
            // var url = location.href;

            // function make_card(msg) {
            //     for (let i = 0; i < 10; i++) {
            //         let temp = msg.documents[i].isbn.split(' ');
            //         let no = temp[1];
            //         let url = msg.documents[i].thumbnail;
            //         let name = msg.documents[i].title;
            //         let author = msg.documents[i].authors;
            //         let publish = msg.documents[i].publisher;
            //         temp = msg.documents[i].datetime.split('-');
            //         let year = temp[0];
            //         let price = msg.documents[i].price;

            //         let v_no = '"' + no + '"';
            //         let v_url = '"' + url + '"';
            //         let v_name = '"' + name + '"';
            //         let v_author = '"' + author + '"';
            //         let v_publish = '"' + publish + '"';
            //         let v_year = '"' + year + '"';
            //         let v_price = '"' + price + '"';

            //         if(url == ""){
            //             let v_url = " ";
            //             $(".context").append( "<div class='card col'> <div class='card-body'> <h5 class='card-title'>"
            //                                 + name + "</h5> <p class='card-text'>작가: " + author + "<br> 출판사: " + publish + "<br> 출판년도: " + year + "<br> 가격: " 
            //                                 + price + "<br> </p> <input type='button' value='선택' onclick='opener.parent.isbnValue(" + v_no + ", " + v_name 
            //                                 + ", " + v_author + ", " + v_publish + ", " + v_year + ", " + v_price +"); window.close();'> </div> </div>" );
            //         }else{
            //             $(".context").append( "<div class='card col'> <img src = '" + url + "' class='card-img-top' alt='...'> <div class='card-body'> <h5 class='card-title'>"
            //                                 + name + "</h5> <p class='card-text'>작가: " + author + "<br> 출판사: " + publish + "<br> 출판년도: " + year + "<br> 가격: " 
            //                                 + price + "<br> </p> <input type='button' value='선택' onclick='opener.parent.isbnValue(" + v_no + ", " + v_name 
            //                                 + ", " + v_author + ", " + v_publish + ", " + v_year + ", " + v_price +"); window.close();'> </div> </div>" );
            //         }
            //     }
            // }

            // function search(){
            //     $.ajax({
            //         method: "GET",
            //         url: "https://dapi.kakao.com/v3/search/book?sort=accuracy&page=" + page_num,
            //         data: { query : search_name },
            //         headers : { Authorization: "KakaoAK 4a10552ea42f3e71bb5c39c7994f8602"}
            //     })
            //     .done(function (msg) {
            //         var cnt = msg.meta.total_count;
                            
            //         totalPages = cnt / 10;
            //         console.log(totalPages);

            //         if(totalPages > 100){
            //             totalPages = 100;
            //         }

            //         $(".context").empty();
            //         $("#pagination").empty();

            //         $(function () {
            //             window.pagObj = $('#pagination').twbsPagination({
            //                 totalPages: totalPages,
            //                 visiblePages: 10,
            //                 prev: "‹",
            //                 next: "›",
            //                 first: '«',
            //                 last: '»',
            //                 onPageClick: function (event, page) {
            //                     page_num = page;
            //                 }
            //             }).on('page', function (event, page) {
            //                     $.ajax({
            //                         method: "GET",
            //                         url: "https://dapi.kakao.com/v3/search/book?sort=accuracy&page=" + page_num,
            //                         data: { query : search_name },
            //                         headers : { Authorization: "KakaoAK 4a10552ea42f3e71bb5c39c7994f8602"}
            //                     })
            //                     .done(function (msg) {
            //                         $(".context").empty();
            //                         make_card(msg);
            //                     });
            //                 });
            //         });
            //         make_card(msg);
            //     });
            // }

            // if(window.location.search != ""){
            //     let t_array = window.location.href.split('?');

            //     url = t_array[0];
            //     first = false;
            //     search_name = decodeURI(window.location.search.slice(1));
            //     $("#bookname").val(search_name);

            //     search();
            // }

            // $(document).ready(function(){
            //     $("#search").click(function(){
            //         if(first){
            //             search_name = $("#bookname").val();
            //             first = false;
            //         }else{
            //             location.href = url + "?"+ $("#bookname").val(); 
            //         }
            //         search();
            //     });
            // });
        </script>
    </body>
</html>